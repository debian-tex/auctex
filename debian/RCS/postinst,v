head	1.18;
access;
symbols
	9­8i-2:1.3
	auctex_9-8i-1:1.2;
locks; strict;
comment	@# @;


1.18
date	98.02.22.22.29.27;	author salve;	state Exp;
branches;
next	1.17;

1.17
date	98.02.19.17.58.32;	author salve;	state Exp;
branches;
next	1.16;

1.16
date	98.02.18.18.30.58;	author salve;	state Exp;
branches;
next	1.15;

1.15
date	98.02.18.18.28.42;	author salve;	state Exp;
branches;
next	1.14;

1.14
date	98.02.18.17.18.44;	author salve;	state Exp;
branches;
next	1.13;

1.13
date	98.02.18.13.32.14;	author salve;	state Exp;
branches;
next	1.12;

1.12
date	98.02.17.18.08.01;	author salve;	state Exp;
branches;
next	1.11;

1.11
date	98.01.25.01.08.50;	author salve;	state Exp;
branches;
next	1.10;

1.10
date	98.01.20.23.07.33;	author salve;	state Exp;
branches;
next	1.9;

1.9
date	98.01.20.01.21.58;	author salve;	state Exp;
branches;
next	1.8;

1.8
date	98.01.20.01.03.08;	author salve;	state Exp;
branches;
next	1.7;

1.7
date	98.01.20.00.56.39;	author salve;	state Exp;
branches;
next	1.6;

1.6
date	98.01.19.23.57.33;	author salve;	state Exp;
branches;
next	1.5;

1.5
date	98.01.19.19.50.20;	author salve;	state Exp;
branches;
next	1.4;

1.4
date	98.01.17.16.39.34;	author salve;	state Exp;
branches;
next	1.3;

1.3
date	98.01.12.18.59.11;	author salve;	state Exp;
branches;
next	1.2;

1.2
date	98.01.08.13.57.37;	author salve;	state Exp;
branches;
next	1.1;

1.1
date	97.12.30.17.45.01;	author salve;	state Exp;
branches;
next	;


desc
@Original Helmut Geyer's version.
@


1.18
log
@To set fill-column in Local Variables is PLAIN WRONG.
@
text
@#!/bin/bash -e
#
# postinst configuration file for Debian auctex package.
# $Id: postinst,v 1.17 1998/02/19 17:58:32 salve Exp salve $
#
# This program is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published by the
# Free Software Foundation; either version 2 of the License, or (at your
# option) any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
#
# You should have received a copy of the GNU General Public License along
# with this program; if not, write to: The Free Software Foundation, Inc.,
# 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
#
# On Debian GNU/Linux System you can find a copy of the GNU General Public
# License in /usr/doc/copyright/GPL.

set -o posix

PACKAGE=auctex

function run_auto_generate () {
	cat <<-EOF
		AUC TeX can parse all TeX macros packages and LaTeX style files for
		information. This improves the performance of AUC TeX a lot. As this may
		need a lot of time when running for the first time, you may want to run it
		in the background or later by running /usr/sbin/update-auctex-elisp.  If
		you run it in background you will get a log file in:
		    /tmp/update-auctex-elisp.log
	EOF
	answer=
	while [ "$answer" != "r" -a "$answer" != "b" -a "$answer" != "l" ]; do
	    read -e -p "Please answer run/background/later (r/b/l): " answer
	done
	case $answer in
	    r) /usr/sbin/update-auctex-elisp;;
	    b) /usr/sbin/update-auctex-elisp &> /tmp/update-auctex-elisp.log &;;
	    l) :;;
	esac
}

# Helmut's stuff: apparently this is a workaround for a defective
# prerm|postrm in that old version.  Better to keep it.
if [ "$1" = "configure" -a "$2" = "9.4g" ]; then 
    install-info --quiet --remove /usr/info/auctex.gz
fi

case "$1" in
    configure|abort-upgrade|abort-deconfigure|abort-remove)
	/usr/lib/emacsen-common/emacs-package-install $PACKAGE
	install-info --section "Document Preparation" "Document Preparation"
		     --menuentry="AUC TeX" \
		     --description="An integrated environment for TeX and LaTeX. " \
		     --quiet /usr/info/auctex.gz
	test -x /usr/bin/update-menus && update-menus && sleep 3
	if [ "$1" = "configure" ]; then
	    # Do we have old stuff still around?
	    for i in /usr/lib/emacs/common/auctex/auto/ /var/lib/emacs/auctex/; do
		if [ -d $i ]; then
		    # We seem to have autos in that old location: let's remove 'em.
		    rm -rf $i
		    echo "Information: old auto generated files have been removed from:"
		    echo "	$i."
		fi
	    done
	    # Do we need to rebuild autos?

	    # Since its a bit too difficult (dgms) to check if the version
	    # we are upgrading from is lower than some other version, I'll
	    # assume we do always need to rebuild autos.  After all it
	    # does no harm.
	    # Anyway, that some other version should be 9.8i-3: we changed
	    # from /var/lib/emacs/auctex to /var/lib/auctex!
	    if [ ! -d /var/lib/auctex ]; then
		run_auto_generate
	    fi
	fi
	exit 0
    ;;
    *)
	echo "postinst called with unknow argument \`$1'" >&2
	exit 0
    ;;
esac

### Local Variables:
### mode: shell-script
### End:
@


1.17
log
@Updated GPL blurb.
@
text
@d4 1
a4 1
# $Id: postinst,v 1.16 1998/02/18 18:30:58 salve Exp salve $
d6 4
a9 1
# Copyright © Davide G. M. Salvetti <salve@@debian.org>, 1997, 1998.
d11 4
a14 2
# This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.
a15 3
# This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
# without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
# See the GNU General Public License for more details.
d17 6
a22 3
# You should have received a copy of the GNU General Public License along with this program; if not, write to:
#	The Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
# On Debian GNU/Linux System you can find a copy of the GNU General Public License in /usr/doc/copyright/GPL.
d48 2
a49 1
# Helmut's stuff: apparently this is a workaround for a defective prerm|postrm in that old version.  Better to keep it.
d57 4
a60 2
	install-info --section "Document Preparation" "Document Preparation" --menuentry="AUC TeX" \
		     --description="An integrated environment for TeX and LaTeX. " --quiet /usr/info/auctex.gz
d73 7
a79 3
	    # Since its a bit too difficult (dgms) to check if the version we are upgrading from is lower than some other version,
	    # I'll assume we do always need to rebuild autos.  After all it does no harm.
	    # Anyway, that some other version should be 9.8i-3: we changed from /var/lib/emacs/auctex to /var/lib/auctex!
a93 1
### fill-column: 132
@


1.16
log
@Added sleep after update-menus.
@
text
@d4 1
a4 1
# $Id: postinst,v 1.15 1998/02/18 18:28:42 salve Exp salve $
d15 3
a17 3
# You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software
# Foundation, Inc., 675 Mass Ave., Cambridge, MA 02139, USA.  On Debian GNU/Linux System you can find a copy of the GNU General
# Public License in /usr/doc/copyright/GPL.
@


1.15
log
@*** empty log message ***
@
text
@d4 1
a4 1
# $Id: postinst,v 1.14 1998/02/18 17:18:44 salve Exp salve $
d50 1
a50 1
	/usr/lib/emacsen-common/emacs-package-install $PACKAGE;
d52 2
a53 2
		     --description="An integrated environment for TeX and LaTeX. " --quiet /usr/info/auctex.gz;
	test -x /usr/bin/update-menus && update-menus;
d69 1
a69 1
		run_auto_generate;
d72 1
a72 1
	exit 0;
@


1.14
log
@/var/lib/emacs/auctex/ -> /var/lib/auctex/
@
text
@d4 1
a4 1
# $Id: postinst,v 1.13 1998/02/18 13:32:14 salve Exp salve $
d30 1
a30 1
		/tmp/auctex-auto-load.log
d38 1
a38 1
	    b) /usr/sbin/update-auctex-elisp &> /tmp/auctex-auto-load.log &;;
d50 1
a50 1
	/usr/lib/emacsen-common/emacs-package-install $PACKAGE
d52 2
a53 2
		     --description="An integrated environment for TeX and LaTeX. " --quiet /usr/info/auctex.gz
	test -x /usr/bin/update-menus && update-menus
d67 4
a70 2
	    # Anyway, that some other version should be 9.8i-3.
	    run_auto_generate
d72 1
a72 1
	exit 0
@


1.13
log
@Added GPL blurb.
@
text
@d4 1
a4 1
# $Id: postinst,v 1.12 1998/02/17 18:08:01 salve Exp salve $
d56 8
a63 8
	    if [ -d /usr/lib/emacs/common/auctex/auto/ ]; then
		# We seem to have autos in that old location: let's remove 'em.
		rm -rf /usr/lib/emacs/common/auctex/auto/
		echo "Information: old auto generated files have been removed from:"
		echo "	/usr/lib/emacs/common/auctex/auto/."
	    fi
	    # Byte-compiled elisp autos directly under /var/lib/emacs/auctex/ should be removed.
	    rm -f /var/lib/emacs/auctex/*.elc
d67 1
@


1.12
log
@New emacsen proposal and other stuff.
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.11 1998/01/25 01:08:50 salve Exp salve $	
d6 12
a17 2
# Written by Helmut Geyer <Helmut.Geyer@@iwr.uni-heidelberg.de>.
# Modified by Davide G. M. Salvetti <salve@@debian.org> on Tue, 30 Dec 1997 11:07:00 CET.
@


1.11
log
@Moved info to section "Document Preparation".
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.10 1998/01/20 23:07:33 salve Exp salve $	
d11 2
d14 17
a30 17
    cat <<EOF
AUC TeX can parse all TeX macros packages and LaTeX style files for
information. This improves the performance of AUC TeX a lot. As this may
need a lot of time when running for the first time, you may want to run it
in the background or later by running /usr/sbin/auctex-auto-load.  If you
run it in background you will get a log file in:
    /tmp/auctex-auto-load.log
EOF
    answer=
    while [ "$answer" != "r" -a "$answer" != "b" -a "$answer" != "l" ]; do
	read -e -p "Please answer run/background/later (r/b/l): " answer
    done
    case $answer in
	r) /usr/sbin/auctex-auto-load;;
	b) /usr/sbin/auctex-auto-load &> /tmp/auctex-auto-load.log &;;
	l) :;;
    esac
a32 24
### Old Helmut's stuff ###########################################################################################################
# Maybe we could remove this one day, if we start depending on some emacsen version greater than an appropriate value.

SITE_FIX=

for i in /etc/xemacs/site-start.el /etc/emacs/site-start.el /usr/lib/xemacs/site-lisp/site-start.el \
	 /usr/lib/xemacs/site-lisp/site-start-19.el /usr/lib/xemacs/site-lisp/site-start-20.el \
	 /usr/lib/emacs/site-lisp/site-start.el; do
    if [ -e $i ]; then
        if [ "$(grep tex-site $i)" != "" ]; then
            SITE_FIX="$SITE_FIX $i"
        fi
    fi
done

if [ "$SITE_FIX" != "" ]; then
    echo "The following files mention tex-site.el, even though they shouldn\'t:"
    echo "  $SITE_FIX "
    echo "please remove the load or require command from these files."
    echo -n "press <return> to proceed."
    read junk
fi
### Old Helmut's stuff ###########################################################################################################

d38 28
a65 29
# Do we need to rebuild autos?
if [ "$1" = "configure" ]; then
    if [ -d /usr/lib/emacs/common/auctex/auto/ ]; then
	# We seem to have valid autos in old location: let's move 'em to the new one if it doesn't already exist.
	if [ ! -d /var/lib/emacs/auctex/ ]; then
	    cp -a /usr/lib/emacs/common/auctex/auto/ /var/lib/emacs/auctex/ && rm -rf /usr/lib/emacs/common/auctex/auto/
	    echo "Information: auto generated files have been moved from"
	    echo "/usr/lib/emacs/common/auctex/auto/ to /var/lib/emacs/auctex/."
	    echo "You can run auctex-auto-load if you want to upgrade them, but you"
	    echo "shouldn't need to do it."
	else
	    # We will assume /usr/lib/emacs/common/auctex/auto/ is stale and /var/lib/emacs/auctex/ has the right stuff into.
	    rm -rf /usr/lib/emacs/common/auctex/auto/
	    echo "Information: old /usr/lib/emacs/common/auctex/auto/ directory has been"
	    echo "removed in favor of /var/lib/emacs/auctex/."
	    echo "You can run auctex-auto-load to upgrade auto generated files in there,"
	    echo "but you shouldn't need to do it."
       	fi
    elif [ ! -d /var/lib/emacs/auctex/ ]; then
	run_auto_generate
    fi
fi

install-info --section "Document Preparation" "Document Preparation" --menuentry="AUC TeX" \
	     --description="An integrated environment for TeX and LaTeX. " --quiet /usr/info/auctex.gz

if [ -x /usr/bin/update-menus ]; then
    update-menus
fi
@


1.10
log
@Info description changed.
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.9 1998/01/20 01:21:58 salve Exp salve $	
d83 1
a83 1
install-info --section Emacs Emacs --menuentry="AUC TeX" \
@


1.9
log
@*** empty log message ***
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.8 1998/01/20 01:03:08 salve Exp salve $	
d84 1
a84 1
	     --description="AUC TeX is an integrated environment for editing LaTeX and TeX files. " --quiet /usr/info/auctex.gz
@


1.8
log
@Added unset answer.
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.7 1998/01/20 00:56:39 salve Exp salve $	
d20 2
a21 1
    unset answer && while [ "$answer" != "r" -a "$answer" != "b" -a "$answer" != "l" ]; do
@


1.7
log
@Prompt rewritten.
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.6 1998/01/19 23:57:33 salve Exp salve $	
d20 1
a20 1
    while [ "$answer" != "r" -a "$answer" != "b" -a "$answer" != "l" ]; do
d49 1
a49 1
    echo -n "press <return> to proceed:"
@


1.6
log
@tex-site.el is no more a conffile: removed link testing and making.
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.5 1998/01/19 19:50:20 salve Exp salve $	
d20 2
a21 11
    fertig=
    until [ ! -z "$fertig" ]; do
	echo -n " Please answer run/background/later (r/b/l): "
	read answer
	case $answer in
	    r) /usr/sbin/auctex-auto-load
		fertig=j;;
	    b) /usr/sbin/auctex-auto-load &> /tmp/auctex-auto-load.log &
		fertig=j;;
	    l) fertig=j;;
	esac
d23 5
@


1.5
log
@Changed info section to Emacs.
Added support for `menu'.
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.4 1998/01/17 16:39:34 salve Exp salve $	
d11 1
a11 3
SITE_FIX=

run_auto_generate () {
d34 4
a37 8
for i in /etc/xemacs/site-start-19.d /etc/emacs/site-start.d /etc/xemacs/site-start-20.d ; do
    if [ -d $i ]; then
	cd $i
	if [ ! -L 50tex-site.el ] ; then
	    ln -s ../../elisp/tex-site.el 50tex-site.el
	fi
    fi
done
d39 3
a41 10
for i in /usr/lib/emacs/site-lisp/ /usr/lib/xemacs/site-lisp/ ; do
    if [ -d $i ]; then
	cd $i
	if [ ! -e tex-site.el ] ; then
	    ln -s /etc/elisp/tex-site.el .
	fi
    fi
done
     
for i in /etc/xemacs/site-start.el /etc/emacs/site-start.el /usr/lib/xemacs/site-lisp/site-start.el /usr/lib/xemacs/site-lisp/site-start-19.el /usr/lib/xemacs/site-lisp/site-start-20.el /usr/lib/emacs/site-lisp/site-start.el; do
d43 1
a43 1
        if [ "`grep tex-site $i`" != "" ]; then
d56 1
d58 1
a60 2
    echo "Warning: tex-site.el has moved from /etc/auctex to /etc/elisp."
    run_auto_generate
d63 1
a64 1
    # Do we need to rebuild autos?
d71 2
a72 2
	    echo "You can run auctex-auto-load if you want to upgrade them, but you should"
	    echo "not need to."
d79 1
a79 1
	    echo "but you should not need to."
@


1.4
log
@*** empty log message ***
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.3 1998/01/12 18:59:11 salve Exp salve $	
d99 6
a104 1
install-info --quiet --section "Elisp Packages" "Elisp Packages" --menuentry="AUC TeX" --description="AUC TeX is an integrated environment for editing LaTeX and TeX files. " /usr/info/auctex.gz
@


1.3
log
@*** empty log message ***
@
text
@d4 1
a4 1
# 	$Id: postinst,v 1.2 1998/01/08 13:57:37 salve Exp salve $	
d6 1
a6 1
# Written by Helmut Geyer <Helmut.Geyer@@iwr.uni-heidelberg.de>
@


1.2
log
@New maintainer.
@
text
@d4 1
a4 1
# 	$Id$	
d29 1
a29 1
	    b) /usr/sbin/auctex-auto-load > /tmp/auctex-auto-load.log 2>&1 &
@


1.1
log
@Initial revision
@
text
@d1 9
a9 2
#!/bin/bash
set -e
d14 20
a33 21
	echo "AUC TeX can parse all TeX macros packages and LaTeX style files
for information. This improves the performance of AUC TeX a lot. As this may
need a lot of time when running for the first time, you may want to run it in
the background or later by running /usr/sbin/auctex-auto-load. 
If you run it in background you will get a log file in
/tmp/auctex-auto-load.log"
	fertig=
	until [ ! -z "$fertig" ]; do
		echo -n " Please answer run/background/later: [r/b/l]"
		read answer
		case $answer in
			r) /usr/sbin/auctex-auto-load
			   fertig=j
			  ;;
			b) /usr/sbin/auctex-auto-load > /tmp/auctex-auto-load.log 2>&1 &
			   fertig=j
			  ;;
		 	l) fertig=j
                          ;;
		esac
	done
d37 4
a40 5
	if [ -d $i ]; then
		cd $i
		if [ ! -L 50tex-site.el ] ; then
			ln -s ../../elisp/tex-site.el 50tex-site.el
		fi
d42 1
d46 4
a49 5
	if [ -d $i ]; then
		cd $i
		if [ ! -e tex-site.el ] ; then
			ln -s /etc/elisp/tex-site.el .
		fi
d51 1
d63 1
a63 1
    echo "The following files mention tex-site.el, even though they shouldn´t:"
d67 1
a67 1
    read $input
d70 4
a73 3
if [ "$1" = "upgrade"  -a "$2" = "9.4g" ]; then 
	install-info --quiet --remove /usr/info/auctex.gz
	run_auto_generate
d76 19
a94 1
if [ "$1" = "install" ]; then
d96 1
d101 4
@
