#include "variables"
#! /bin/bash -e
#
# <% elisp %> emacs remove script for <:=${PACKAGE}:>
#
<:=@COPYRIGHT:>//

set -o posix

FLAVOR=${1}

undo_install () {
    echo >&2 -n "remove/<:=${PACKAGE}:>: Removing for ${FLAVOR}... "
    rm -f <:=if($_="${sstartd}/${EPRIORITY}${PACKAGE}.el")
	    =~s|emacs|\${FLAVOR}|:>
    rm -f <:=if($_=${lisp})=~s|emacs|\${FLAVOR}|:>/../tex-site.el
    rm -f <:=if($_=${lisp})=~s|emacs|\${FLAVOR}|:>/<:=${ELCLOG}:>{,.gz}
    rm -f <:=if($_=${lisp})=~s|emacs|\${FLAVOR}|:>/*.elc
    rm -f <:=if($_=${style})=~s|emacs|\${FLAVOR}|:>/*.elc
    rm -f <:=if($_=${style})=~s|emacs|\${FLAVOR}|:>/.nosearch
    test -d <:=if($_=${style})=~s|emacs|\${FLAVOR}|:> && \
	rmdir --ignore-fail-on-non-empty \
	<:=if($_=${style})=~s|emacs|\${FLAVOR}|:>
    test -d <:=if($_=${lisp})=~s|emacs|\${FLAVOR}|:> && \
	rmdir --ignore-fail-on-non-empty \
	<:=if($_=${lisp})=~s|emacs|\${FLAVOR}|:>
    echo >&2 "done."
    return 0
}

undo_auto () {
    rm -rf <:="${var}/\${FLAVOR}/":>
    return 0
}

case "${FLAVOR}" in
    (emacs) : ;;
    (emacs21|emacs-snapshot)
    <:# remove all parsed information files :>//
    undo_auto
    <:# deinstall :>//
    undo_install
    ;;
    (*) echo >&2 "remove/<:=${PACKAGE}:>:" \
	"Ignoring emacsen flavor: \"${FLAVOR}\""
    ;;
esac

exit 0
<:
# LocalWords:  deinstall
# local variables:
# mode: shell-script
# ispell-local-dictionary: "american"
# ispell-check-comments: exclusive
# end:
# arch-tag: 02840558-59db-42e5-bc45-fe3cce8d379e
:>//
